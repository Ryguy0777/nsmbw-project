// d_CharacterChangeIndicator.cpp
// NSMBW d_bases.text: 0x8076D880 - 0x8076DEE0

#include "d_CharacterChangeIndicator.h"

REPLACE_ASM( //
  0x8076DC80, //
  void dCharacterChangeIndicator_c::UNDEF_8076DC80(),
  // clang-format off
/* 8076DC80 9421FFE0 */  stwu     r1, -32(r1);
/* 8076DC84 7C0802A6 */  mflr     r0;
/* 8076DC88 3C808043 */  lis      r4, UNDEF_8042a308@ha;
/* 8076DC8C 90010024 */  stw      r0, 36(r1);
/* 8076DC90 93E1001C */  stw      r31, 28(r1);
/* 8076DC94 93C10018 */  stw      r30, 24(r1);
/* 8076DC98 7C7E1B78 */  mr       r30, r3;
/* 8076DC9C 93A10014 */  stw      r29, 20(r1);
/* 8076DCA0 93810010 */  stw      r28, 16(r1);
/* 8076DCA4 80A3024C */  lwz      r5, 588(r3);
/* 8076DCA8 80030248 */  lwz      r0, 584(r3);
/* 8076DCAC 8384A308 */  lwz      r28, UNDEF_8042a308@l(r4);
/* 8076DCB0 7C002800 */  cmpw     r0, r5;
/* 8076DCB4 40820078 */  bne-     UNDEF_8076dd2c;
/* 8076DCB8 2C000000 */  cmpwi    r0, 0;
/* 8076DCBC 408201FC */  bne-     UNDEF_8076deb8;
/* 8076DCC0 8003023C */  lwz      r0, 572(r3);
/* 8076DCC4 5400103A */  slwi     r0, r0, 2;
/* 8076DCC8 7C7C0214 */  add      r3, r28, r0;
/* 8076DCCC 80630004 */  lwz      r3, 4(r3);
/* 8076DCD0 8583005C */  lwzu     r12, 92(r3);
/* 8076DCD4 818C0028 */  lwz      r12, 40(r12);
/* 8076DCD8 7D8903A6 */  mtctr    r12;
/* 8076DCDC 4E800421 */  bctrl;
/* 8076DCE0 81830000 */  lwz      r12, 0(r3);
/* 8076DCE4 3C808037 */  lis      r4, UNDEF_80371b70@ha;
/* 8076DCE8 38841B70 */  addi     r4, r4, UNDEF_80371b70@l;
/* 8076DCEC 818C0010 */  lwz      r12, 16(r12);
/* 8076DCF0 7D8903A6 */  mtctr    r12;
/* 8076DCF4 4E800421 */  bctrl;
/* 8076DCF8 2C030000 */  cmpwi    r3, 0;
/* 8076DCFC 408201BC */  bne-     UNDEF_8076deb8;
/* 8076DD00 881E023A */  lbz      r0, 570(r30);
/* 8076DD04 2C000000 */  cmpwi    r0, 0;
/* 8076DD08 418201B0 */  beq-     UNDEF_8076deb8;
/* 8076DD0C 387E0070 */  addi     r3, r30, 112;
/* 8076DD10 38800000 */  li       r4, 0;
/* 8076DD14 38A00000 */  li       r5, 0;
/* 8076DD18 4B95B7A9 */  bl       UNDEF_800c94c0;
/* 8076DD1C 38000000 */  li       r0, 0;
/* 8076DD20 981E023A */  stb      r0, 570(r30);
/* 8076DD24 901E023C */  stw      r0, 572(r30);
/* 8076DD28 48000190 */  b        UNDEF_8076deb8;
UNDEF_8076dd2c:;
/* 8076DD2C 2C050003 */  cmpwi    r5, 3;
/* 8076DD30 41820188 */  beq-     UNDEF_8076deb8;
/* 8076DD34 4B96001D */  bl       UNDEF_800cdd50;
/* 8076DD38 801E024C */  lwz      r0, 588(r30);
/* 8076DD3C 7C7F1B78 */  mr       r31, r3;
/* 8076DD40 3FA08093 */  lis      r29, UNDEF_80933c94@ha;
/* 8076DD44 901E0248 */  stw      r0, 584(r30);
/* 8076DD48 5400103A */  slwi     r0, r0, 2;
/* 8076DD4C 807E0224 */  lwz      r3, 548(r30);
/* 8076DD50 3BBD3C94 */  addi     r29, r29, UNDEF_80933c94@l;
/* 8076DD54 7FE4FB78 */  mr       r4, r31;
/* 8076DD58 7CDD002E */  lwzx     r6, r29, r0;
/* 8076DD5C 38A00002 */  li       r5, 2;
/* 8076DD60 38E00000 */  li       r7, 0;
/* 8076DD64 4CC63182 */  crclr    6;
/* 8076DD68 4B95BDE9 */  bl       UNDEF_800c9b50;
/* 8076DD6C 801E0248 */  lwz      r0, 584(r30);
/* 8076DD70 7FE4FB78 */  mr       r4, r31;
/* 8076DD74 807E0228 */  lwz      r3, 552(r30);
/* 8076DD78 38A00002 */  li       r5, 2;
/* 8076DD7C 5400103A */  slwi     r0, r0, 2;
/* 8076DD80 38E00000 */  li       r7, 0;
/* 8076DD84 7CDD002E */  lwzx     r6, r29, r0;
/* 8076DD88 4CC63182 */  crclr    6;
/* 8076DD8C 4B95BDC5 */  bl       UNDEF_800c9b50;
/* 8076DD90 387E0070 */  addi     r3, r30, 112;
/* 8076DD94 4B95B85D */  bl       UNDEF_800c95f0;
/* 8076DD98 801E0248 */  lwz      r0, 584(r30);
/* 8076DD9C 2C000001 */  cmpwi    r0, 1;
/* 8076DDA0 40820030 */  bne-     UNDEF_8076ddd0;
/* 8076DDA4 387E0070 */  addi     r3, r30, 112;
/* 8076DDA8 38800000 */  li       r4, 0;
/* 8076DDAC 38A00000 */  li       r5, 0;
/* 8076DDB0 4B95B711 */  bl       UNDEF_800c94c0;
/* 8076DDB4 387E0070 */  addi     r3, r30, 112;
/* 8076DDB8 38800002 */  li       r4, 2;
/* 8076DDBC 4B95B6B5 */  bl       UNDEF_800c9470;
/* 8076DDC0 38000000 */  li       r0, 0;
/* 8076DDC4 981E023A */  stb      r0, 570(r30);
/* 8076DDC8 3B80000D */  li       r28, 13;
/* 8076DDCC 480000B4 */  b        UNDEF_8076de80;
UNDEF_8076ddd0:;
/* 8076DDD0 387E0070 */  addi     r3, r30, 112;
/* 8076DDD4 38800001 */  li       r4, 1;
/* 8076DDD8 38A00000 */  li       r5, 0;
/* 8076DDDC 4B95B6E5 */  bl       UNDEF_800c94c0;

                         // Fix 2 button not glowing for P1
// /* 8076DDE0 807E023C */  lwz      r3, 572(r30);
// /* 8076DDE4 2C030000 */  cmpwi    r3, 0;
// /* 8076DDE8 4182007C */  beq-     UNDEF_8076de64;

/* 8076DDEC 801E0248 */  lwz      r0, 584(r30);
/* 8076DDF0 2C000002 */  cmpwi    r0, 2;
/* 8076DDF4 41820040 */  beq-     UNDEF_8076de34;
/* 8076DDE0 807E023C */  lwz      r3, 572(r30);
/* 8076DDF8 5460103A */  slwi     r0, r3, 2;
/* 8076DDFC 7C7C0214 */  add      r3, r28, r0;
/* 8076DE00 80630004 */  lwz      r3, 4(r3);
/* 8076DE04 8583005C */  lwzu     r12, 92(r3);
/* 8076DE08 818C0028 */  lwz      r12, 40(r12);
/* 8076DE0C 7D8903A6 */  mtctr    r12;
/* 8076DE10 4E800421 */  bctrl;
/* 8076DE14 81830000 */  lwz      r12, 0(r3);
/* 8076DE18 3C808037 */  lis      r4, UNDEF_80371b70@ha;
/* 8076DE1C 38841B70 */  addi     r4, r4, UNDEF_80371b70@l;
/* 8076DE20 818C0010 */  lwz      r12, 16(r12);
/* 8076DE24 7D8903A6 */  mtctr    r12;
/* 8076DE28 4E800421 */  bctrl;
/* 8076DE2C 2C030000 */  cmpwi    r3, 0;
/* 8076DE30 41820034 */  beq-     UNDEF_8076de64;
UNDEF_8076de34:;
/* 8076DE34 387E0070 */  addi     r3, r30, 112;
/* 8076DE38 38800000 */  li       r4, 0;
/* 8076DE3C 4B95B635 */  bl       UNDEF_800c9470;
/* 8076DE40 83BE01F4 */  lwz      r29, 500(r30);
/* 8076DE44 C03E0234 */  lfs      f1, 564(r30);
/* 8076DE48 807D0000 */  lwz      r3, 0(r29);
/* 8076DE4C 4B9F5AC5 */  bl       UNDEF_80163910;
/* 8076DE50 7FA3EB78 */  mr       r3, r29;
/* 8076DE54 4B9F67BD */  bl       UNDEF_80164610;
/* 8076DE58 38000001 */  li       r0, 1;
/* 8076DE5C 981E023A */  stb      r0, 570(r30);
/* 8076DE60 4800001C */  b        UNDEF_8076de7c;
UNDEF_8076de64:;
/* 8076DE64 387E0070 */  addi     r3, r30, 112;
/* 8076DE68 38800000 */  li       r4, 0;
/* 8076DE6C 38A00000 */  li       r5, 0;
/* 8076DE70 4B95B651 */  bl       UNDEF_800c94c0;
/* 8076DE74 38000000 */  li       r0, 0;
/* 8076DE78 981E023A */  stb      r0, 570(r30);
UNDEF_8076de7c:;
/* 8076DE7C 3B80000A */  li       r28, 10;
UNDEF_8076de80:;
/* 8076DE80 807E022C */  lwz      r3, 556(r30);
/* 8076DE84 7FE4FB78 */  mr       r4, r31;
/* 8076DE88 7F86E378 */  mr       r6, r28;
/* 8076DE8C 38A00002 */  li       r5, 2;
/* 8076DE90 38E00000 */  li       r7, 0;
/* 8076DE94 4CC63182 */  crclr    6;
/* 8076DE98 4B95BCB9 */  bl       UNDEF_800c9b50;
/* 8076DE9C 807E0230 */  lwz      r3, 560(r30);
/* 8076DEA0 7FE4FB78 */  mr       r4, r31;
/* 8076DEA4 7F86E378 */  mr       r6, r28;
/* 8076DEA8 38A00002 */  li       r5, 2;
/* 8076DEAC 38E00000 */  li       r7, 0;
/* 8076DEB0 4CC63182 */  crclr    6;
/* 8076DEB4 4B95BC9D */  bl       UNDEF_800c9b50;
UNDEF_8076deb8:;
/* 8076DEB8 80010024 */  lwz      r0, 36(r1);
/* 8076DEBC 83E1001C */  lwz      r31, 28(r1);
/* 8076DEC0 83C10018 */  lwz      r30, 24(r1);
/* 8076DEC4 83A10014 */  lwz      r29, 20(r1);
/* 8076DEC8 83810010 */  lwz      r28, 16(r1);
/* 8076DECC 7C0803A6 */  mtlr     r0;
/* 8076DED0 38210020 */  addi     r1, r1, 32;
/* 8076DED4 4E800020 */  blr;
  // clang-format on
);